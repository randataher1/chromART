<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Explore New</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">

    <link href="css/ratchet.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/jumbotron-narrow.css" rel="stylesheet">

    <link href="css/chromart.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.19.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <!--<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>-->


  </head>

  <body>

    <div class="container">
      <div class="pageHeader">
        <img src="img/logo.png" class="logo center" />
      </div>

      <div class="titleText">
        <p>Explore New</p>
      </div>

      <div class="imageScroll">
        <div class="image">
          <div class="row">
            <div class="col-sm-12">
              Image
              <div class="row">
                <div class="col-xs-3">
                  Profile Picture
                </div>
                <div class="col-xs-9">
                  <div class="row">
                    Username
                  </div>
                  <div class="row">
                    Description
                  </div>
                  <div class="row">
                    Hashtags
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div>
        <button type="button" class="btn btn-default logout">Logout</button>
      </div>

      <div class="clear"></div>

      <div>
        <nav class="bar bar-tab">
          <a class="tab-item" href="home.html">
            <span class="icon icon-home"></span>
            <span class="tab-label">Home</span>
          </a>
          <a class="tab-item" href="profile.html">
            <span class="icon icon-person"></span>
            <span class="tab-label">Profile</span>
          </a>
          <a class="tab-item active" href="explore.html">
            <span class="icon icon-pages"></span>
            <span class="tab-label">Explore</span>
          </a>
          <a class="tab-item" href="upload.html">
            <span class="icon icon-share"></span>
            <span class="tab-label">Upload</span>
          </a>
        </nav>
      </div>

    </div> <!-- /container -->

  <script type="text/javascript">
    Parse.initialize("OmBCFAsCIuhnhzrCLtvKyGIdxQHYBW89XS3QqkvP", "mQK3VkWpDgGHoxDH0kroP1UFd7WPUbm0ZT2vzf21");

    //Finding most recenly created images and adding to imageScroll
    var otherImage = Parse.Object.extend("Image");
    var imageQuery = new Parse.Query(otherImage);
    imageQuery.descending("createdAt");
    imageQuery.include('user');
    imageQuery.limit(10);
    imageQuery.find({
      success: function(results) {
        // The object was retrieved successfully.
        //Loops through 10 most recently created images and adds them to the page
        for(var i = 0; i < results.length; i++) {
          var object = results[i];
          var userObject = object.get('user');
          // The object was retrieved successfully.
          $(".imageScroll").append(
            "<div class=\"image\">" +
              "<div class=\"row\">" +
                "<div class=\"col-sm-12\">" +
                  "<img src=\"" + object.get('url') + "\" />" +
                  "<div class=\"row\">" +
                    "<div class=\"col-xs-3\">" +
                      userObject.get('profilePicture') +
                    "</div>" +
                    "<div class=\"col-xs-6\">" +
                      "<div class=\"row\">" +
                        userObject.get('username') +
                      "</div>" +
                      "<div class=\"row\">" +
                        object.get('description') +
                      "</div>" +
                      "<div class=\"row\">" +
                        object.get('hashtag') +
                      "</div>" +
                    "</div>" +
                    "<div class=\"col-xs-3\">" +
                      "<div class=\"row\">" +
                        "Likes" +
                      "</div>" +
                    "</div>" +
                  "</div>" +
                "</div>" +
              "</div>" +
            "</div>");
        }
      },
      error: function(error) {
        // The object was not retrieved successfully.
        // error is a Parse.Error with an error code and description.
        alert("Error retrieving images");
      }
    });
    
    $(".logout").click(function() {
      Parse.User.logOut();
      window.location.href = 'index.html';
    });
  </script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
  </body>
</html>
