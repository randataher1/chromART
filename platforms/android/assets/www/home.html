<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Home</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">

    <link href="css/ratchet.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/jumbotron-narrow.css" rel="stylesheet">

    <link href="css/chromart.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.19.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <!--<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>-->


  </head>

  <body>

    <div class="container">
      <div class="pageHeader">
        <img src="img/logo.png" class="logo center" />
      </div>


      <div class="imageScroll">
        <div class="image">
          <div class="row">
            <div class="col-sm-12">
              Image
              <div class="row">
                <div class="col-xs-3">
                  Profile Picture
                </div>
                <div class="col-xs-5">
                  <div class="row">
                    Username
                  </div>
                  <div class="row">
                    Description
                  </div>
                  <div class="row">
                    Hashtags
                  </div>
                </div>
                <div class="col-xs-2">
                  <button type="button" class="btn btn-default btn-sm like">
                    <span class="glyphicon glyphicon-thumbs-up"></span>
                  </button>
                </div>
                <div class="col-xs-1">
                  <button type="button" class="btn btn-default btn-sm dislike">
                    <span class="glyphicon glyphicon-thumbs-down"></span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div>
        <button type="button" class="btn btn-default logout">Logout</button>
      </div>

      <div class="clear"></div>

      <div>
        <nav class="bar bar-tab">
          <a class="tab-item active" href="home.html">
            <span class="icon icon-home"></span>
            <span class="tab-label">Home</span>
          </a>
          <a class="tab-item" href="profile.html?userID=">
            <span class="icon icon-person"></span>
            <span class="tab-label">Profile</span>
          </a>
          <a class="tab-item" href="explore.html">
            <span class="icon icon-pages"></span>
            <span class="tab-label">Explore</span>
          </a>
          <a class="tab-item" href="upload.html">
            <span class="icon icon-share"></span>
            <span class="tab-label">Upload</span>
          </a>
        </nav>
      </div>

    </div> <!-- /container -->


<script type="text/javascript">
    Parse.initialize("Og5SrfaWadYcXArMTgGM1gJwHy750LoBtJVRV0JA", "aCd8Z5xLTOomMPazIG4i8z691PncoCBnKjW5iL1u");

    //Returns all Follow objects of the current user
    function searchForFollowedUserObjects () {
      var Follow = Parse.Object.extend("Follow");
      var followQuery = new Parse.Query(Follow);
      followQuery.equalTo("user", Parse.User.current());
      followQuery.include("user");
      followQuery.find({
        success: function(followResults) {
          alert("Found followed users");
          console.log(followResults);
          return followResults;
        },
        error: function(error) {
          alert("Error finding followed users");
        }
      });
    }

    var x = searchForFollowedUserObjects();

    //Returns all Image objects of followed users
    function searchForImagesUploadedBy (followedUsers) {
      var Img = Parse.Object.extend("Image");
      var imageQuery = new Parse.Query(Img);
      imageQuery.descending("createdAt");
      //imageQuery.containedIn("user", followedUsers);
      imageQuery.include(["user.image"]);
      imageQuery.find({
        success: function(imageResults) {
          alert("Found images of followed users");
          console.log(imageResults);
          return imageResults;
        },
        error: function (error) {
          alert("Error finding images of followed users");
        }
      });
    }

    searchForImagesUploadedBy(x);

    // //Returns all ImageLike objects of images
    // function searchForUserLikeOf (imageUploadedByFollowedUser) {
    //   var imageLikeObject = Parse.Object.extend("ImageLike");
    //   var imageLikeQuery = new Parse.Query(imageLikeObject);
    //   //Look for an existing ImageLike object that points to current user and the image
    //   imageLikeQuery.include(['user.image']);
    //   imageLikeQuery.equalTo("user", Parse.User.current());
    //   imageLikeQuery.equalTo("image", imageUploadedByFollowedUser);
    //   imageLikeQuery.find({
    //     success: function(imageLikeResults) {
    //       alert("Found user likes of images");
    //       console.log(ImageLikeResults);
    //       return imageLikeResults;
    //     },
    //     error: function (error) {
    //       alert("Error finding likes of images of followed users");
    //     }
    //   });
    // }

    // //Creates array of Follow objects
    // var followedUserObjects = searchForFollowedUserObjects();

    // //Takes all Follow objects and puts their followedUser values into an array to access the users that the current user follows
    // var followedUsers = [];
    // $.each(followedUserObjects, function(object, user) {
    //   followedUsers[object] = user.get('followedUser');
    // });

    // //Creates array of Image objects of followed users
    // var imagesUploadedByFollowedUsers = searchForImagesUploadedBy(followedUsers);

    // for(var eachImage = 0; eachImage < imagesUploadedByFollowedUsers.length; eachImage++) {
    //   var imageObject = imagesUploadedByFollowedUsers[eachImage];
    //   var userWhoCreatedImage = imageObject.get('user');
    //   $(".imageScroll").append(
    //     "<div class=\"image\">" +
    //       "<div class=\"row\">" +
    //         "<div class=\"col-sm-12\">" +
    //         "<img class=\"imageResize\" src=\"" + imageObject.get('url') + "\" />" +
    //         "<div class=\"row\">" +
    //           "<div class=\"col-xs-3\"><a href=\"profile.html?userID=" +
    //           userWhoCreatedImage.id +"\">" + 
    //           "<img class=\"img-circle imageProfilePicture\" src=\"" +
    //             userWhoCreatedImage.get('profilePictureUrl') +
    //           "\" />" +
    //           "</a></div>" +
    //             "<div class=\"col-xs-5\">" +
    //               "<div class=\"row\"><a href=\"profile.html?userID=" +
    //                 userWhoCreatedImage.id + "\">" + userWhoCreatedImage.get('username') +
    //               "</a></div>" +
    //               "<div class=\"row\">" +
    //                 imageObject.get('description') +
    //               "</div>" +
    //               "<div class=\"row\">" +
    //                 imageObject.get('hashtag') +
    //               "</div>" +
    //             "</div>" +
    //             "<div class=\"col-xs-2\">" +
    //               "<button type=\"button\" id=\"imageLike" + eachImage +
    //               "\" class=\"btn btn-default btn-sm like\">" +
    //                 "<span class=\"glyphicon glyphicon-thumbs-up\"></span>" +
    //               "</button>" +
    //             "</div>" +
    //             "<div class=\"col-xs-1\">" +
    //               "<button type=\"button\" id=\"imageDislike" + eachImage +
    //               "\" class=\"btn btn-default btn-sm dislike\">" +
    //                 "<span class=\"glyphicon glyphicon-thumbs-down\"></span>" +
    //               "</button>" +
    //             "</div>" +
    //           "</div>" +
    //         "</div>" +
    //       "</div>" +
    //     "</div>");

    //   var likeObject = searchForUserLikeOf(imageObject);

    //   //If there isn't, alerts user
    //   if(likeObject.length === 0) {
    //     alert("No likes for image: " + imageObject.id);
    //   }
    //   //If there is an object with type like, make the like button active
    //   else if(likeObject[0].get("type") === "like") {
    //     $("#imageLike" + eachImage).addClass("active");
    //   }
    //   //If there is an object with type dislike, make the dislike button active
    //   else {
    //     $("#imageDislike" + eachImage).addClass("active");
    //   }

    //   //Adds like functionality to like button
    //   $("#imageLike" + eachImage).click(function() {
    //     //If the like button is clicked and there isn't an ImageLike object, creates a new one with type like
    //     if(likeObject.length === 0) {
    //       $("#imageLike" + eachImage).addClass("active");
    //       var imageLikeObject = Parse.Object.extend("ImageLike");
    //       var imageLike = new imageLikeObject();
    //       imageLike.set("user", Parse.User.current());
    //       imageLike.set("image", imageObject);
    //       imageLike.set("type", "like");
    //       imageLike.save(null, {
    //         success: function(object) {
    //           alert("Successfully created new ImageLike object with type like!");
    //         },
    //         error: function(object, error) {
    //           alert("Failed to create new ImageLike object with type like");
    //         }
    //       });
    //     }
    //     //If there is a like object with type like, removes the like object
    //     else if (likeObject[0].get("type") === "like") {
    //       $("#imageLike" + eachImage).removeClass("active");
    //       likeObject[0].destroy({});
    //       alert("Successfully destroyed ImageLike object with type like!");
    //     }
    //     //If there is a like object with type dislike, changes the type of the object
    //     else {
    //       $("#imageDislike" + eachImage).removeClass("active");
    //       $("#imageLike" + eachImage).addClass("active");
    //       likeObject[0].set("type", "like");
    //       likeObject[0].save(null, {
    //         success: function(object) {
    //           alert("Successfully changed type of ImageLike object to type like!");
    //         },
    //         error: function(object, error) {
    //           alert("Failed to change type of ImageLike object to type like");
    //         }
    //       });
    //     }
    //   });

    //   //Adds like functionality to dislike button
    //   $("#imageDislike" + eachImage).click(function() {
    //     //If the dislike button is clicked and there isn't an ImageLike object, creates a new one with type dislike
    //     if(likeObject.length === 0) {
    //       $("#imageDislike" + eachImage).addClass("active");
    //       var imageLikeObject = Parse.Object.extend("ImageLike");
    //       var imageLike = new imageLikeObject();
    //       imageLike.set("user", Parse.User.current());
    //       imageLike.set("image", imageObject);
    //       imageLike.set("type", "dislike");
    //       imageLike.save(null, {
    //         success: function(object) {
    //           alert("Successfully created new ImageLike object with type dislike!");
    //         },
    //         error: function(object, error) {
    //           alert("Failed to create new ImageLike object with type dislike");
    //         }
    //       });
    //     }
    //     //If there is a like object with type dislike, removes the like object
    //     else if (likeObject[0].get("type") === "dislike") {
    //       $("#imageDislike" + eachImage).removeClass("active");
    //       likeObject[0].destroy({});
    //       alert("Successfully destroyed ImageLike object with type dislike!");
    //     }
    //     //If there is a like object with type like, changes the type of the object
    //     else {
    //       $("#imageLike" + eachImage).removeClass("active");
    //       $("#imageDislike" + eachImage).addClass("active");
    //       likeObject[0].set("type", "dislike");
    //       likeObject[0].save(null, {
    //         success: function(object) {
    //           alert("Successfully changed type of ImageLike object to type dislike!");
    //         },
    //         error: function(object, error) {
    //           alert("Failed to change type of ImageLike object to type dislike");
    //         }
    //       });
    //     }
        
    //   });
    // }
    
    $(".logout").click(function() {
      Parse.User.logOut();
      window.location.href = 'index.html';
    });
  </script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
  </body>
</html>
